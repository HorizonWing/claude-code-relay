# Claude Code Relay 环境配置文件
# 复制此文件为 .env 并根据实际环境修改配置值

# 服务器配置
PORT=8080
GIN_MODE=release
HTTP_CLIENT_TIMEOUT=120

# MySQL数据库配置
MYSQL_HOST=localhost
MYSQL_PORT=3306
MYSQL_USER=root
MYSQL_PASSWORD=your-mysql-password
MYSQL_DATABASE=claude_code_relay

# MySQL连接池配置
MYSQL_MAX_OPEN_CONNS=100
MYSQL_MAX_IDLE_CONNS=10
MYSQL_MAX_LIFETIME_MINUTES=60
MYSQL_MAX_IDLE_TIME_MINUTES=30

# Redis配置
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# Session配置
SESSION_SECRET=your-secret-key-here
JWT_SECRET=your-secret-key-here

# 日志配置
LOG_LEVEL=info
LOG_FILE=./logs/app.log
LOG_RECORD_API=false

# 日志保留配置
LOG_RETENTION_MONTHS=3

# 密码加密盐值配置
SALT=your-salt-here

# 默认管理员账号配置
DEFAULT_ADMIN_USERNAME=admin
DEFAULT_ADMIN_PASSWORD=admin123
DEFAULT_ADMIN_EMAIL=admin@example.com

# 邮件服务配置
SMTP_SERVER=smtp.qq.com
SMTP_PORT=465
SMTP_ACCOUNT=your_email@qq.com
SMTP_PASSWORD=your_smtp_password

# Fallback机制配置
# 账号故障转移和负载均衡配置，提供高可用性和容错能力
FALLBACK_MAX_RETRIES=3                          # 最大重试次数，当账号失败时尝试其他账号的次数
FALLBACK_RETRY_DELAY=0                          # 重试延迟时间，0表示立即重试，支持ms/s/m/h单位 (如: 500ms, 2s)
FALLBACK_STRATEGY=priority_first                # 账号选择策略:
                                               #   priority_first - 按优先级排序(推荐)
                                               #   weighted - 按权重分配
                                               #   round_robin - 轮询选择
                                               #   least_used - 最少使用优先
FALLBACK_ENABLE_CIRCUIT_BREAKER=true            # 是否启用熔断器，防止连续失败导致系统过载
FALLBACK_CIRCUIT_BREAKER_THRESHOLD=5            # 熔断器阈值，连续失败多少次后开启熔断器
FALLBACK_FAILURE_WINDOW=5m                      # 故障窗口时间，统计故障的时间窗口
FALLBACK_RECOVERY_WINDOW=10m                    # 恢复窗口时间，熔断器从开启到半开状态的等待时间
FALLBACK_ENABLE_HEALTH_CHECK=true               # 是否启用健康检查，自动监控账号状态
FALLBACK_HEALTH_CHECK_INTERVAL=2m               # 健康检查间隔时间，多久检查一次账号健康状态
SMTP_FROM=your_email@qq.com
SMTP_SSL_ENABLED=false
SYSTEM_NAME=Claude Code Relay

# 邮件缓存配置（防止重复发送）
EMAIL_CACHE_ENABLED=true
EMAIL_CACHE_EXPIRE_TIME=300